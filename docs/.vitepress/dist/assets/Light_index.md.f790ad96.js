import{V as t,p as n,a as s,d as a,r as e,b as p,e as i,w as o,f as c,o as l,c as u,g as r,h as d,i as h,v as k,u as g,t as b,j as m,k as f}from"./app.ceccd6b0.js";import{V as y,b as x}from"./index.e1633dd4.js";class L extends y{constructor(t){super(t),this.initModel()}init(){var t;this.initSky(),this.initSource(),this.model.playAllClipes(this.sceneidx),this.sky.initShaderSky({scale:1e4,turbidity:2,rayleigh:4,postion:[15,.5,-20]}),null==(t=this.ambient)||t.setLight(.5,.7)}clearLight(){var t;null==(t=this.ambient)||t.setLight(1,.7),this.hemisphereLight&&this.hemisphereLight.destory(),this.directional&&this.directional.destory(),this.pointGroup[this.pointIndex]&&this.pointGroup[this.pointIndex].destory(),this.spotLight&&this.spotLight.destory(),this.rectAreaLight&&this.rectAreaLight.destory(),console.log(this.scene)}setLight(){var t;this.clearLight(),null==(t=this.ambient)||t.setLight(1.5,1)}setSkyLight(){this.clearLight(),this.initSkyLight("#66dd7a","#66dd7a",2),this.hemisphereLight.light.position.set(0,180,0),this.hemisphereLight.initHelper(30)}setDirectional(){this.clearLight(),this.initDirectional("#db5847",2),this.directional.light.position.set(50,100,-50),this.directional.initHelper(40),this.directional.light.shadow.mapSize.x=8192,this.directional.light.shadow.mapSize.y=8192}setPoint(){this.clearLight(),this.pointIndex=this.initPointLight("#db5847",3,0),this.pointGroup[this.pointIndex].light.position.set(200,200,-200),this.pointGroup[this.pointIndex].initHelper(40),this.pointGroup[this.pointIndex].light.castShadow=!0}setSpot(){this.clearLight(),this.initSpotLight("#db5847",5,600,new t(0,0,0)),this.spotLight.light.position.set(0,300,0),this.spotLight.light.angle=.8,this.spotLight.initHelper(30)}setRect(){this.clearLight(),this.initRectArea("#fff",100,100,30),this.rectAreaLight.light.position.set(100,100,100),this.rectAreaLight.light.lookAt(0,0,0),this.rectAreaLight.initHelper(30)}setRectBox(){this.clearLight(),this.initRectAreaBox("#fff",140,5,[10,0,50]),this.rectAreaLight.initBoxHelper(30)}setRectBoxNoHelper(){this.clearLight(),this.initRectAreaBox("#66dd7a",150,5,[10,0,50])}}n("data-v-e38e75f6");const v={class:"wrap"},w={class:"loading"},A=m('<div class="loading-text" data-v-e38e75f6><span class="loading-text-words" data-v-e38e75f6>L</span><span class="loading-text-words" data-v-e38e75f6>O</span><span class="loading-text-words" data-v-e38e75f6>A</span><span class="loading-text-words" data-v-e38e75f6>D</span><span class="loading-text-words" data-v-e38e75f6>I</span><span class="loading-text-words" data-v-e38e75f6>N</span><span class="loading-text-words" data-v-e38e75f6>G</span></div>',1),S={class:"loding-percent"},I={class:"container"},q={class:"container-text"},R=r("span",null,"场景光",-1),_=r("span",null,"半球光",-1),C=r("span",null,"平行光",-1),V=r("span",null,"点光源",-1),B=r("span",null,"聚光灯",-1),H=r("span",null,"区域光",-1),P=r("span",null,"光盒",-1),G=r("span",null,"无辅助光盒",-1);s();var T=a({props:{sceneId:{type:String,default:"0"},visible:{type:Boolean,default:!1}},setup(t){const n=t,s=e();let a,m=e(!0),f=e(!1),y=e(""),T=e("0");p((()=>{D()})),i((()=>{a&&a.destroy(),x.off("scene")})),x.on("scene",(t=>{({loading:()=>{T.value=t.progressNum,m.value=t.value},transition:()=>{f.value=t.value}})[t.type]()})),o((()=>T),(t=>{x.emit("progressNum",g(t)),parseInt(g(t))>=100&&setTimeout((()=>{m.value=!1,f.value=!0,setTimeout((()=>{f.value=!1}),1500)}),1e3)}),{deep:!0}),o((()=>n.sceneId),(()=>{}),{deep:!0,immediate:!0});const D=()=>{const t=s.value;a=new L({el:t,tween:c,path:"../public/scene/"}),J(5)},N=()=>{a.setLight()},j=()=>{a.setSkyLight()},z=()=>{a.setDirectional()},O=()=>{a.setPoint()},E=()=>{a.setSpot()},M=()=>{a.setRect()},U=()=>{a.setRectBox()},F=()=>{a.setRectBoxNoHelper()},J=t=>{switch(t){case 5:a.setScene(5,(()=>{a.init()})),y.value="灯光",a.flyTo({position:[36.6,80.6,328.1],controls:[0,0,0],duration:2e3})}};return(t,n)=>(l(),u("div",null,[r("div",v,[d("    loding"),h(r("div",w,[A,r("div",S,b(parseInt(g(T)))+"%",1)],512),[[k,g(m)]]),d("转场动画"),h(r("div",I,[r("span",q,b(g(y)),1)],512),[[k,g(f)]]),r("div",{ref:s,id:"map",class:"map"},null,512)]),r("div",{class:"btn"},[r("button",{class:"custom-btn btn-3",onClick:N},[R]),r("button",{class:"custom-btn btn-6",onClick:j},[_]),r("button",{class:"custom-btn btn-16",onClick:z},[C]),r("button",{class:"custom-btn btn-8",onClick:O},[V])]),r("div",{class:"btn"},[r("button",{class:"custom-btn btn-3",onClick:E},[B]),r("button",{class:"custom-btn btn-6",onClick:M},[H]),r("button",{class:"custom-btn btn-16",onClick:U},[P]),r("button",{class:"custom-btn btn-8",onClick:F},[G])])]))}});T.__scopeId="data-v-e38e75f6";const D=r("h1",{id:"灯光类"},[r("a",{class:"header-anchor",href:"#灯光类","aria-hidden":"true"},"#"),f(" 灯光类")],-1),N=m('<h2 id="使用"><a class="header-anchor" href="#使用" aria-hidden="true">#</a> 使用</h2><div class="language-js"><pre><code><span class="token keyword">this</span><span class="token punctuation">.</span>ambient<span class="token punctuation">.</span><span class="token function">setLight</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//场景光</span>\n<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initSkyLight</span><span class="token punctuation">(</span><span class="token string">&quot;#66dd7a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;#66dd7a&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//半球光</span>\n<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initDirectional</span><span class="token punctuation">(</span><span class="token string">&quot;#db5847&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//平行光</span>\n<span class="token keyword">this</span><span class="token punctuation">.</span>pointIndex <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initPointLight</span><span class="token punctuation">(</span><span class="token string">&quot;#db5847&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//点光源</span>\n<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initSpotLight</span><span class="token punctuation">(</span><span class="token string">&quot;#db5847&quot;</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//聚光灯</span>\n<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initRectArea</span><span class="token punctuation">(</span><span class="token string">&quot;#fff&quot;</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//区域光</span>\n<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initRectAreaBox</span><span class="token punctuation">(</span><span class="token string">&quot;#fff&quot;</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//光盒</span>\n\n<span class="token comment">//初始化光的位置是0,0,0(修改位置等信息见下方)</span>\n<span class="token function">setRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">clearLight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initRectArea</span><span class="token punctuation">(</span><span class="token string">&quot;#fff&quot;</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>rectAreaLight<span class="token punctuation">.</span>light<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>rectAreaLight<span class="token punctuation">.</span>light<span class="token punctuation">.</span><span class="token function">lookAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>rectAreaLight<span class="token punctuation">.</span><span class="token function">initHelper</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre></div><h2 id="api"><a class="header-anchor" href="#api" aria-hidden="true">#</a> API</h2><table><thead><tr><th>Viewer</th><th style="text-align:left;"></th><th></th></tr></thead><tbody><tr><td>属性</td><td style="text-align:left;">描述</td><td>类型</td></tr><tr><td>ambient</td><td style="text-align:left;">构造器对象（Viewer 中通过 this.ambient 访问）</td><td>场景光类</td></tr><tr><td>hemisphereLight</td><td style="text-align:left;">构造器对象（Viewer 中通过 this.hemisphereLight 访问）</td><td>半球光类</td></tr><tr><td>directional</td><td style="text-align:left;">构造器对象（Viewer 中通过 this.directional 访问）</td><td>平行光类</td></tr><tr><td>pointGroup</td><td style="text-align:left;">构造器对象（Viewer 中通过 this.pointGroup 访问）</td><td>点光源组类</td></tr><tr><td>spotLight</td><td style="text-align:left;">构造器对象（Viewer 中通过 this.spotLight 访问）</td><td>聚光灯类</td></tr><tr><td>rectAreaLight</td><td style="text-align:left;">构造器对象（Viewer 中通过 this.rectAreaLight 访问）</td><td>区域光类</td></tr><tr><td>方法</td><td style="text-align:left;">参数</td><td>描述</td></tr><tr><td>initSkyLight</td><td style="text-align:left;">skyColor:天空光颜色(string),<br>earthColor:地板光颜色(string),<br>intensity:强度(number)</td><td>半球光初始化</td></tr><tr><td>initDirectional</td><td style="text-align:left;">color:光颜色(string),<br>intensity:强度(number)</td><td>平行光初始化</td></tr><tr><td>initPointLight</td><td style="text-align:left;">color:光颜色(string),<br>intensity:强度(number),<br>distance:距离(number), decay?:衰减(number)=&gt;pointGroup 中的下标</td><td>点光源初始化</td></tr><tr><td>initSpotLight</td><td style="text-align:left;">color:光颜色(string),<br>intensity:强度(number),<br>distance:距离(number), target?:聚焦位置(Vector3)</td><td>聚光灯初始化</td></tr><tr><td>initRectArea</td><td style="text-align:left;">color:光颜色(string),<br>width:宽度(number),<br>height:高度(number),<br>intensity:强度(number)</td><td>区域光初始化</td></tr><tr><td>initRectAreaBox</td><td style="text-align:left;">color:光颜色(string),<br>width:宽度(number),<br>height:高度(number),<br>intensity:强度(number),<br>position:位置(number[])</td><td>光盒初始化</td></tr></tbody></table><table><thead><tr><th>各实例下</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td>属性</td><td style="text-align:left;"></td></tr><tr><td>light</td><td style="text-align:left;">光对象(通过这里修改光的属性)</td></tr><tr><td>helper</td><td style="text-align:left;">光辅助对象</td></tr><tr><td>方法</td><td style="text-align:left;">描述</td></tr><tr><td>initHelper</td><td style="text-align:left;">光辅助对象初始化</td></tr><tr><td>destory</td><td style="text-align:left;">销毁光</td></tr><tr><td>initBoxHelper(光盒特有)</td><td style="text-align:left;">光盒辅助对象初始化</td></tr></tbody></table>',5),j='{"title":"灯光类","description":"","frontmatter":{},"headers":[{"level":2,"title":"使用","slug":"使用"},{"level":2,"title":"API","slug":"api"}],"relativePath":"Light/index.md","lastUpdated":1679141062942}',z={};const O=Object.assign(z,{setup:function(t){return(t,n)=>(l(),u("div",null,[D,r(T),N]))}});export default O;export{j as __pageData};
