import{a7 as t,aC as a,al as e,p as s,a as n,d as i,r as d,b as o,e as r,w as l,f as p,o as c,c as h,g as u,h as b,i as k,v as g,u as w,t as m,j as v,V as x,k as f}from"./app.ceccd6b0.js";import{V as y,b as A}from"./index.e1633dd4.js";class j extends y{constructor(t){super(t),this.initModel()}init(){this.pipeLineArr=[],this.mark=new t,this.initSource(),this.initSky(),this.setEvent(),this.initFlyModel(),this.addTransform(),this.initEnvironment({path:"exr.exr",type:"exr"}),this.sky.setSkyBox("sky4"),this.initparade(),this.flyTo({position:[-49,53,3],controls:[0,0,0],duration:2e3})}setRectBox(){}setRectArea(){this.initRectArea("#fff",10,10,200),this.rectAreaLight.light.position.set(0,100,0)}setRectBoxPosition(t,a=5){this.rectAreaLight.areaLight.children.forEach(((e,s)=>{switch(s){case 0:e.position.set(t[0],a+t[1],t[2]),e.lookAt(t[0],a/2,t[2]);break;case 1:e.position.set(a/2+t[0],a/2+t[1],t[2]),e.lookAt(t[0],a/2+t[1],t[2]);break;case 2:e.position.set(-a/2+t[0],a/2+t[1],t[2]),e.lookAt(t[0],a/2+t[1],t[2]);break;case 3:e.position.set(t[0],t[1],t[2]),e.lookAt(t[0],a/2+t[1],t[2]);break;case 4:e.position.set(t[0],a/2+t[1],a/2+t[2]),e.lookAt(t[0],a/2+t[1],t[2]);break;case 5:e.position.set(t[0],a/2+t[1],-a/2+t[2]),e.lookAt(t[0],a/2+t[1],t[2])}}))}initFlyModel(){this.model.loadModel(this.options.path+"glb/model.glb",this.sceneidx,(t=>{let s=["Object_14","Object_13","Object_12","Object_11","Object_10"];t.scale.set(1.3,1.3,1.3),t.visible=!1,this.flyModel=t,this.flyModel.traverse((t=>{t instanceof a&&t.material.isMeshStandardMaterial&&(t.material.color=new e("#292c33"),t.material.roughness=.1,t.material.metalness=1,t.material.envMapIntensity=2,s.includes(t.name)&&(t.material.emissive=new e("#14cecd"),t.material.emissiveIntensity=20))})),this.scene.add(t),this.setRectArea()}))}addTransform(){this.controls.initTransform(this.sceneidx),this.controls.transformControls.setSize(.7),this.controls.transformControls.addEventListener("dragging-changed",(t=>{this.controls.orbitControls.enabled=!t.value,this.pipeLineArr[this.currentMark.userData.index]=this.currentMark.position.clone(),t.value||(this.controls.transformControls.detach(),this.reload())}))}reload(){this.parade.clear(),this.mark.clear(),this.parade.drawPipeLine(this.pipeLineArr)}initparade(){let t=this.souce.loadTexture({path:"/docs/public/images/line.png"});this.initParade({pipeParams:{tubularSegments:80,radius:.15,radialSegments:16,closed:!1},pipeTexture:t,scene:this.gScenes[this.sceneidx],animate:this.animate.animateFuntion,speed:1,object:this.object}),this.animate.animateFuntion.push((a=>{t.offset.x-=a/2}))}initMark(){this.pipeLineArr.map(((t,a)=>{let e=this.loadSprite({texture:this.souce.loadTexture({path:"/docs/public/images/cycle.png"}),name:"mark"});e.position.copy(t),e.userData.index=a,e.scale.set(.1,.1,.1),this.mark.add(e)})),this.gRayGroup[this.sceneidx].add(this.mark)}startParade(){this.reload(),this.parade.pipeLine.visible=!1,this.controls.orbitControls.enabled=!0,this.controls.transformControls.detach(),this.parade.autoParade(((a,{point:e,pointLook:s})=>{"start"===a?this.object instanceof t&&(this.activeCamera.position.set(s.x-1,s.y+5,s.z-12),this.activeCamera.lookAt(e),this.rectAreaLight.light.position.set(e.x,e.y+3,e.z+2),this.rectAreaLight.light.lookAt(e)):(this.controls.orbitControls.enabled=!1,this.parade.stop=!0,this.parade.progress=0,this.parade.direction="GO",this.parade.pipeLine.visible=!0,this.ambient.setLight(1.5,.7),this.flyTo({position:[-49,53,3],controls:[0,0,0],duration:2e3}))}))}setEvent(){this.initEvent(["click","dblclick"]),this.event.typesFn.click.push((t=>{"Sprite"===t.list[0].object.type&&(this.currentMark=t.list[0].object.parent,this.controls.transformControls.attach(t.list[0].object.parent))}))}}s("data-v-d9d5d66a");const L={class:"wrap"},P={class:"loading"},C=v('<div class="loading-text" data-v-d9d5d66a><span class="loading-text-words" data-v-d9d5d66a>L</span><span class="loading-text-words" data-v-d9d5d66a>O</span><span class="loading-text-words" data-v-d9d5d66a>A</span><span class="loading-text-words" data-v-d9d5d66a>D</span><span class="loading-text-words" data-v-d9d5d66a>I</span><span class="loading-text-words" data-v-d9d5d66a>N</span><span class="loading-text-words" data-v-d9d5d66a>G</span></div>',1),T={class:"loding-percent"},_={class:"container"},S={class:"container-text"},M={class:"tips"},I=v('<div class="loading-text" data-v-d9d5d66a><span class="loading-text-words" data-v-d9d5d66a>点</span><span class="loading-text-words" data-v-d9d5d66a>机</span><span class="loading-text-words" data-v-d9d5d66a>选</span><span class="loading-text-words" data-v-d9d5d66a>择</span><span class="loading-text-words" data-v-d9d5d66a>巡</span><span class="loading-text-words" data-v-d9d5d66a>游</span><span class="loading-text-words" data-v-d9d5d66a>类</span><span class="loading-text-words" data-v-d9d5d66a>型</span></div>',1),O=u("span",null,"请先规划线路!",-1),V=u("span",null,"相机巡游",-1),D=u("span",null,"请先规划线路!",-1),E=u("span",null,"模型巡游",-1);n();var R=i({props:{sceneId:{type:String,default:"0"},visible:{type:Boolean,default:!1}},setup(t){const a=t,e=d();let s,n=d(!0),i=d(!0),v=d(!1),f=d(""),y=d("0");o((()=>{R()})),r((()=>{s&&s.destroy(),A.off("scene")})),A.on("scene",(t=>{({loading:()=>{y.value=t.progressNum,i.value=t.value},transition:()=>{v.value=t.value}})[t.type]()})),l((()=>y),(t=>{A.emit("progressNum",w(t)),parseInt(w(t))>=100&&setTimeout((()=>{i.value=!1,v.value=!0,setTimeout((()=>{v.value=!1}),1500)}),1e3)}),{deep:!0}),l((()=>a.sceneId),(()=>{}),{deep:!0,immediate:!0});const R=()=>{const t=e.value;s=new j({el:t,tween:p,path:"../public/scene/"}),F("1")},F=t=>{switch(t){case"1":s.setScene(7,(()=>{s.init()})),f.value="巡游"}},B=()=>{s.pipeLineArr=[new x(.3,1,-490),new x(10.3,10,-450),new x(.3,1,-400),new x(.3,10,-350),new x(.3,5,-300),new x(-10.3,20,-250),new x(.3,3,-200),new x(.3,5,-150),new x(5.3,10,-100),new x(10.3,20,-70),new x(.3,20,-80),new x(-5.3,20,-90),new x(-10.3,10,-120),new x(10.3,5,-90),new x(.3,1,-50),new x(.3,10,0),new x(.3,5,50),new x(.3,50,100),new x(.3,5,150),new x(.3,1,200),new x(-5,1,212),new x(-10,1,215),new x(-38.78130509587943,1,215.28061921604808),new x(-78.78130509587943,1,215.28061921604808),new x(-79.78130509587943,1,215.28061921604808),new x(-80.78130509587943,1,215.28061921604808)],s.parade.object=s.activeCamera,s.flyModel.visible=!1,s.object=s.activeCamera,s.startParade()},G=()=>{s.pipeLineArr=[new x(.3,0,-490),new x(.3,0,-450),new x(.3,0,-400),new x(.3,0,-350),new x(.3,0,-300),new x(.3,0,-250),new x(.3,0,-200),new x(.3,0,-150),new x(.3,0,-100),new x(.3,0,-50),new x(.3,0,0),new x(.3,0,50),new x(.3,0,100),new x(.3,0,150),new x(.3,0,200),new x(-5,0,212),new x(-10,0,215),new x(-38.78130509587943,0,215.28061921604808),new x(-78.78130509587943,0,215.28061921604808),new x(-79.78130509587943,0,215.28061921604808),new x(-80.78130509587943,0,215.28061921604808)],s.ambient.setLight(.01,.1),s.parade.object=s.flyModel,s.object=s.flyModel,s.flyModel.visible=!0,s.startParade()};return(t,a)=>(c(),h("div",null,[u("div",L,[b("    loding"),k(u("div",P,[C,u("div",T,m(parseInt(w(y)))+"%",1)],512),[[g,w(i)]]),b("转场动画"),k(u("div",_,[u("span",S,m(w(f)),1)],512),[[g,w(v)]]),u("div",{ref:e,id:"map",class:"map"},null,512),k(u("div",M,[I],512),[[g,w(n)]])]),u("div",{class:"btn"},[u("button",{class:"custom-btn btn-12",onClick:B},[O,V]),u("button",{class:"custom-btn btn-12",onClick:G},[D,E])])]))}});R.__scopeId="data-v-d9d5d66a";const F=u("h1",{id:"巡游类"},[u("a",{class:"header-anchor",href:"#巡游类","aria-hidden":"true"},"#"),f(" 巡游类")],-1),B=v('',5),G='{"title":"巡游类","description":"","frontmatter":{},"headers":[{"level":2,"title":"使用","slug":"使用"},{"level":2,"title":"API","slug":"api"}],"relativePath":"Parade/index.md","lastUpdated":1679227446975}',N={};const z=Object.assign(N,{setup:function(t){return(t,a)=>(c(),h("div",null,[F,u(R),B]))}});export default z;export{G as __pageData};
